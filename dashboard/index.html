
<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<title>Resgate - Hello World Example</title>
		<script src="https://unpkg.com/resclient@latest/dist/resclient.min.js"></script>
	</head>
	<body>
            <div id="root">
                <br/>
                Discovered systems:<br/>
            </div>

            <div id= "shardroot">
                <br/>
                Discovered shards:<br/>
            </div>

		<script>
			const ResClient = resclient.default;
			let client = new ResClient('ws://localhost:8080');
            let root = document.getElementById("root");
            
			client.get('decs.systems').then(systems => {                
                systems.toArray().forEach(element => {
                    var sys = document.createElement("div");
                    sys.innerText = element.name + ' (' + element.components + ') @ ' + element.framerate + "fps";
                    root.appendChild(sys);
                    console.log(element);
                });				
			}).catch(err => {
                console.log(err);
				document.body.textContent = "Error getting model. Are NATS Server and Resgate running?";
			});

            client.get('decs.shards').then(shards => {                
                shards.toArray().forEach(element => {
                    var shard = document.createElement("div");
                    shard.innerText = element.name + ' (' + element.current + '/' + element.capacity + ');'
                    shardroot.appendChild(shard);
                    console.log(element);
                });				
			}).catch(err => {
                console.log(err);
				document.body.textContent = "Error getting model. Are NATS Server and Resgate running?";
			});
        </script>

        
	</body>
</html>